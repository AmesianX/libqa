{{!--
Created by IntelliJ IDEA.
User: yion
Date: 2014. 12. 7.
Time: 16:20
To change this template use File | Settings | File Templates.
--}}

{{#partial "title"}}LibQA~{{/partial}}

{{# partial "content" }}
<!-- contents -->

<div class="container">
    <div class="col-md" >
        <div style="padding-bottom: 45px;">
            <div class="btn-group" data-toggle="buttons" style="float: right">
                <a class="btn btn-primary" id="cancelFavorite" style="display: none;"><i class="fa fa-heart-o"></i> 즐겨찾기 취소</a>
                <a class="btn btn-primary" id="addFavorite" style="display: none;"><i class="fa fa-heart"></i> 즐겨찾기 추가</a>
                <a class="btn btn-primary" id="createWiki"><i class="fa fa-pencil"></i> 위키 생성</a>
                <a href="#" class="btn btn-primary"><i class="fa fa-file-text"></i> 첨부파일 목록</a>
                <a href="#" id="editSpace" class="btn btn-primary"><i class="fa fa-pencil-square-o"></i>  공간 정보수정</a>
            </div>
        </div>
    </div>

</div>

<!--// contents -->


<div class="container components">
    <h1>{{space.title}}</h1>
    <hr>

    <div class="col-xs-12 col-sm-9">

        <div class="jumbotron">
            <img src="{{space.titleImagePath}}/{{space.titleImage}}" width="250">
            <p>{{space.description}}</p>
        </div>

        <div class="row row-offcanvas row-offcanvas-right">

            <h3>최근 수정된 위키 목록</h3>
            <blockquote class="pull-left">
                {{> space/template/_updateWikiRight}}
            </blockquote>

            <hr>


            <h3>최근 이 공간의 활동 내역 목록 </h3>
            <blockquote class="pull-left">
                {{> space/template/_activityList}}
            </blockquote>

        </div><!--/row-->
    </div><!--/span-->

    <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
        <div class="well sidebar-nav">
            {{#if spaceWikis}}
                {{#each spaceWikis}}
                    <a href="/wiki/{{wikiId}}">{{title}}</a><BR>
                {{/each}}
            {{^}}
                생성된 위키가 없습니다.
            {{/if}}
        </div><!--/.well -->
    </div><!--/span-->
</div>
</div>

{{/partial}}


{{# partial "script-page" }}
    <script type="text/javascript">
        // bind the on-change event
        $(document).ready(function() {
            var userFavorite = "{{userFavorite}}";

            console.log("## userFavorite = " + userFavorite);
            if (userFavorite == '') {
                $("#addFavorite").css("display","block");
            } else {
                $("#cancelFavorite").css("display","block");
            }

            $('#createWiki').on('click', function () {
                $('#space').attr({action:'/wiki/write', method:'post'}).submit();
            });

            $('#editSpace').on('click', function () {
                $('#space').attr({action:'/space/edit/{{space.spaceId}}', method:'get'}).submit();
            });

            $('#getMoreWiki').on('click', function () {
                alert('더 가져오기');
            });

            $('#addFavorite').on('click', function () {
                var spaceId = {{space.spaceId}};
                $.ajax({
                    url: "/space/addFavorite",
                    data: { spaceId : spaceId },
                    type: "GET",
                    success : function(data){
                        console.log("data = " + data);

                        if (data == 1) {
                            $.alert({
                                title: '확인',
                                content: '즐겨찾기 추가 완료',
                                confirmButton: 'OK',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'zoom',
                                confirm: function () {
                                }
                            });

                            $("#addFavorite").css("display","none");
                            $("#cancelFavorite").css("display","block");
                        } else if (data == 0) {
                            $.alert({
                                title: '확인',
                                content: '사용자 정보가 존재하지 않습니다. 로그인 후 다시 시도하세요.',
                                confirmButton: 'OK',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'zoom',
                                confirm: function () {
                                }
                            });
                        }
                    },
                    error : function(req){
                        $.alert({
                            title: '확인',
                            content: '즐겨찾기 추가가 되지 않았습니다. 다시 시도하세요.',
                            confirmButton: 'OK',
                            confirmButtonClass: 'btn-primary',
                            icon: 'fa fa-info',
                            animation: 'zoom',
                            confirm: function () {
                            }
                        });
                    }
                })
            });

            $('#cancelFavorite').on('click', function () {
                var spaceId = {{space.spaceId}};
                $.ajax({
                    url: "/space/cancelFavorite",
                    data: { spaceId : spaceId },
                    type: "GET",
                    success : function(data){
                        console.log("data = " + data);

                        if (data == 1) {
                            $.alert({
                                title: '확인',
                                content: '즐겨찾기 취소 완료',
                                confirmButton: 'OK',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'zoom',
                                confirm: function () {
                                }
                            });

                            $("#addFavorite").css("display","block");
                            $("#cancelFavorite").css("display","none");
                        } else if (data == 0) {
                            $.alert({
                                title: '확인',
                                content: '사용자 정보가 존재하지 않거나 만료 되었습니다. 다시 로그인 하세요.',
                                confirmButton: 'OK',
                                confirmButtonClass: 'btn-primary',
                                icon: 'fa fa-info',
                                animation: 'zoom',
                                confirm: function () {
                                }
                            });
                        }
                    },
                    error : function(req){
                        $.alert({
                            title: '확인',
                            content: '즐겨찾기 취소가 되지 않았습니다. 다시 시도하세요.',
                            confirmButton: 'OK',
                            confirmButtonClass: 'btn-primary',
                            icon: 'fa fa-info',
                            animation: 'zoom',
                            confirm: function () {
                            }
                        });
                    }
                })
            });
        });
    </script>
{{/partial}}

{{> template/base}}
